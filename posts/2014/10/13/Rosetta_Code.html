<p>So I signed up at <a href="http://rosettacode.org">rosetta code</a> the other day (guess I get a little bored on vacations…). For those of you who are not familiar with the site (<em>visit <a href="http://rosettacode.org">it</a></em>), it basically a collection of problems with solutions written in all sort of languages. So I glanced at the open problems for my <a href="http://www.scala-lang.org">favourite language</a>, and saw a few <a href="http://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci</a> related tasks that are just ripe for the taking. The first few problems were too simple to write about, but one of these problems (<a href="http://rosettacode.org/wiki/Fibonacci_word/fractal">Fibonacci word fractal</a>) caught my attention, and made a good experience to share here.</p>
<p>Well, in short, the Fibonacci word \(f(n)\) is constructed by concatenating \(f(n-1)\) with \(f(n-2)\), where \(f(0)=“1”\) and \(f(1)=“0”\):</p>
<table>
<thead>
<tr class="header">
<th>word</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>\(f(0)\)</td>
<td>\(“1”\)</td>
</tr>
<tr class="even">
<td>\(f(1)\)</td>
<td>\(“0”\)</td>
</tr>
<tr class="odd">
<td>\(f(n)\)</td>
<td>\(_f(n-1) \cdot f(n-2)\)</td>
</tr>
</tbody>
</table>
<p>The fractal is defined by the word \(f(n)\) where \(n \rightarrow \infty\), and the rules for constructing the fractal from the word are:</p>
<pre><code class="sourceCode">For i = 0 to f(n).length
  Draw a segment forward 
  If current Character is &#39;0&#39;
    If i is even turn left
    Else if i is odd turn right</code></pre>
<p>When I saw it, it reminded me SVG paths, so I thought, why not create a SVG image instead of ascii art? Turning right or left relatively with drawing of only straight lines fits perfectly to <a href="http://www.w3.org/TR/SVG/paths.html#PathDataLinetoCommands">SVG path lineTo command</a>. So, the idea is to convert a fibonacci word into a seqeunce of commands.</p>
<div style="text-align:center">
<svg height="320" width="320">
<polygon style="fill:#ffc000;stroke:#cc4000;stroke-width:1" points="160,0 100,80 140,50 140,140 50,140 80,100 0,160 80,220 50,180 140,180 140,270 100,240 160,320 220,240 180,270 180,180 270,180 240,220 320,160 240,100 270,140 180,140 180,50 220,80"></polygon> <text y="167" style="font-family:Sans-Serif;font-size:larger;font-weight:bold" fill="#cc4000" x="60">(-1,0)</text> <text y="167" style="font-family:Sans-Serif;font-size:larger;font-weight:bold" fill="#cc4000" x="210">(1,0)</text> <text y="167" style="font-family:Sans-Serif;font-size:larger;font-weight:bold" fill="#cc4000" x="40" transform="rotate(270 160,160)">(0,1)</text> <text y="167" style="font-family:Sans-Serif;font-size:larger;font-weight:bold" fill="#cc4000" x="60" transform="rotate(90 160,160)">(0,-1)</text>
</svg>
</div>
<p>First thing I had to do, was to get the Fibonacci word. this can be easily achieved with an <code>Iterator</code>, note that I’m gonna show here a more complicated with better performance variant of the code I submitted to rosetta code.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">val</span> it = Iterator.<span class="fu">iterate</span>((Seq(<span class="ch">&#39;1&#39;</span>),Seq(<span class="ch">&#39;0&#39;</span>))){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>  <span class="kw">case</span> (f1,f2) =&gt; (f2,f2++f1)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>}.<span class="fu">map</span>(_._<span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co">//let&#39;s take f(20) as our word</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="kw">val</span> word = it.<span class="fu">drop</span>(<span class="dv">20</span>).<span class="fu">next</span></span></code></pre></div>
<p>well, now I needed to translate the left and right turns into absolute Up/Left/Down/Right movements. ok, that’s simple too. Since a direction is based on a preceding direction, we need “turning functions”:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">val</span> leftTo: PartialFunction[Char,Char] = </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>  Map(<span class="ch">&#39;R&#39;</span> -&gt; <span class="ch">&#39;U&#39;</span>, <span class="ch">&#39;U&#39;</span> -&gt; <span class="ch">&#39;L&#39;</span>, <span class="ch">&#39;L&#39;</span> -&gt; <span class="ch">&#39;D&#39;</span>, <span class="ch">&#39;D&#39;</span> -&gt; <span class="ch">&#39;R&#39;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="kw">val</span> rightTo: PartialFunction[Char,Char] = </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>  Map(<span class="ch">&#39;R&#39;</span> -&gt; <span class="ch">&#39;D&#39;</span>, <span class="ch">&#39;D&#39;</span> -&gt; <span class="ch">&#39;L&#39;</span>, <span class="ch">&#39;L&#39;</span> -&gt; <span class="ch">&#39;U&#39;</span>, <span class="ch">&#39;U&#39;</span> -&gt; <span class="ch">&#39;R&#39;</span>)</span></code></pre></div>
<p>and with these in hand, a simple(?) fold would do the trick:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co">/* The fold should result with a tuple of (Vector[Char],Boolean)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co"> * The Boolean value signifies if the char index is even (true) </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="co"> * or odd (false), and is not needed after the fold.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>word.<span class="fu">foldLeft</span>((Vector(<span class="ch">&#39;R&#39;</span>),<span class="kw">true</span>)){</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>  <span class="kw">case</span> ((v,parity),<span class="ch">&#39;1&#39;</span>) =&gt; (v :+ v.<span class="fu">last</span>, !parity)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>  <span class="kw">case</span> ((v,<span class="kw">true</span>),<span class="ch">&#39;0&#39;</span>)   =&gt; (v :+ <span class="fu">leftTo</span>(v.<span class="fu">last</span>), <span class="kw">false</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>  <span class="kw">case</span> ((v,<span class="kw">false</span>),<span class="ch">&#39;0&#39;</span>)  =&gt; (v :+ <span class="fu">rightTo</span>(v.<span class="fu">last</span>), <span class="kw">true</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>}._<span class="dv">1</span></span></code></pre></div>
<p>But since we’re interested in an efficient solution, and the resulting sequence from the fold still needs to be traversed again to generate the suitable commands, I’ll rewrite the turning functions &amp; the fold to be less clear, but the fold will result in (almost) exactly what we need.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">type</span> SVGCommand = (Char,Int) <span class="co">// now you see where I&#39;m getting at... right?</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="kw">val</span> leftTo: PartialFunction[SVGCommand,SVGCommand] = {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="kw">val</span> rightTo: PartialFunction[SVGCommand,SVGCommand] = {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>  <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>and the fold will now look like:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">val</span> commands = word.<span class="fu">foldLeft</span>(Vector(<span class="ch">&#39;h&#39;</span> -&gt; <span class="dv">1</span>),<span class="kw">true</span>){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>  <span class="kw">case</span> ((v,parity),<span class="ch">&#39;1&#39;</span>) <span class="kw">if</span> v.<span class="fu">last</span>._<span class="dv">2</span> &gt; <span class="dv">0</span> =&gt; </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>    (v.<span class="fu">init</span> :+ (v.<span class="fu">last</span>._<span class="dv">1</span>, v.<span class="fu">last</span>._<span class="dv">2</span> + <span class="dv">1</span>), !parity) </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>  <span class="kw">case</span> ((v,parity),<span class="ch">&#39;1&#39;</span>) <span class="kw">if</span> v.<span class="fu">last</span>._<span class="dv">2</span> &lt; <span class="dv">0</span> =&gt; </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>    (v.<span class="fu">init</span> :+ (v.<span class="fu">last</span>._<span class="dv">1</span>, v.<span class="fu">last</span>._<span class="dv">2</span> - <span class="dv">1</span>), !parity)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>  <span class="kw">case</span> ((v,<span class="kw">true</span>), <span class="ch">&#39;0&#39;</span>) =&gt; (v :+ <span class="fu">leftTo</span>(v.<span class="fu">last</span>), <span class="kw">false</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a>  <span class="kw">case</span> ((v,<span class="kw">false</span>),<span class="ch">&#39;0&#39;</span>) =&gt; (v :+ <span class="fu">rightTo</span>(v.<span class="fu">last</span>), <span class="kw">true</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>}._<span class="dv">1</span></span></code></pre></div>
<p>OK, so the “hard work” is done. All we need now, is to create the SVG:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co">//just trust me with the width, height and starting position... it works. </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="kw">val</span> buff = <span class="kw">new</span> StringBuilder(<span class="st">&quot;&quot;&quot;&lt;svg height=&quot;</span><span class="dv">172</span><span class="st">&quot; width=&quot;</span><span class="dv">411</span><span class="st">&quot;&gt;&quot;&quot;&quot;</span> + </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="st">&quot;&quot;&quot;&lt;path style=&quot;</span>stroke:#<span class="dv">000</span>;stroke-width:<span class="dv">1</span><span class="st">&quot; &quot;&quot;&quot;</span> + </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="st">&quot;&quot;&quot;stroke-linejoin=&quot;</span>miter<span class="st">&quot; fill=&quot;</span>none<span class="st">&quot; d=&quot;</span>M <span class="dv">2</span> <span class="dv">170</span> <span class="st">&quot;&quot;&quot;)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>commands.<span class="fu">foreach</span>{<span class="kw">case</span> (c,i) =&gt; buff.<span class="fu">append</span>(s<span class="st">&quot; $c $i&quot;</span>)}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>buff.<span class="fu">append</span>(<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">/&gt;&lt;/svg&gt;&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="fu">println</span>(buff.<span class="fu">mkString</span>) <span class="co">//or write to a file, or whatever...</span></span></code></pre></div>
<p>and here’s the output:</p>
<div style="text-align:center">
<svg height="172" width="411">
<path style="stroke:#FFB01C;stroke-width:1" stroke-linejoin="miter" fill="none" d="M 2 170  h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 1 v 2 h -2 v -1 h -2 v 2 h 1 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -1 h -2 v 2 h 1 v 2 h -2 v -1 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2 h -2 v 1 h -2 v -2 h 1 v -2 h -1 v -2 h 2 v 1 h 2 v -1 h 2 v 2 h -1 v 2 h 2 v -1 h 2 v 1 h 2 v -2 h -1 v -2 h 1 v -2"/>Your browser does not support inline SVG, so you’ll have to run the code and see for yourself the output
</svg>
</div>
<p>Final version of the code, optimized a bit more (exploiting the fold to populate the handler instead of creating an entire unneeded collection), which takes arguments to generate the image to your liking is given here:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>  <span class="co">/**</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>   <span class="co">* </span><span class="an">@param n </span>               <span class="co">-</span> The Fibonacci word to draw f<span class="co">(</span>n<span class="co">)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param </span><span class="co">                 </span><span class="an">- </span>height image height</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param </span><span class="co">                 </span><span class="an">- </span>width  image width</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param xStart </span>          <span class="co">-</span> X coordinate to start the path from</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param yStart </span>          <span class="co">-</span> Y coordinate to start the path from</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param color </span>           <span class="co">-</span> path<span class="co">&#39;</span>s color</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param lengthMultiplier </span><span class="co">-</span> control how long segments are</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@param stringHandler </span>   <span class="co">-</span> input function to handle appends</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>   <span class="co">*</span> <span class="an">@return </span>the SVG string</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>   <span class="co">*/</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a>  <span class="kw">def</span> <span class="fu">drawFibonacciFractal</span>(n: Int, height: Int, width: Int, xStart: Int, yStart: Int, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>      color: String, lengthMultiplier: Int)(stringHandler: String =&gt; Unit): Unit = {</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a>    <span class="kw">type</span> SVGCommand = (Char,Int)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true"></a>    <span class="kw">val</span> leftTo: PartialFunction[SVGCommand,SVGCommand] = {</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true"></a>    }</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true"></a>    <span class="kw">val</span> rightTo: PartialFunction[SVGCommand,SVGCommand] = {</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;h&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;v&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &gt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,-<span class="dv">1</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true"></a>      <span class="kw">case</span> (<span class="ch">&#39;v&#39;</span>,i) <span class="kw">if</span> i &lt; <span class="dv">0</span> =&gt; (<span class="ch">&#39;h&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true"></a>    }</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true"></a>    <span class="fu">stringHandler</span>(s<span class="st">&quot;&quot;&quot;&lt;svg height=&quot;</span>${height}<span class="st">&quot; width=&quot;</span>${width}<span class="st">&quot;&gt;&quot;&quot;&quot;</span> + </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true"></a>s<span class="st">&quot;&quot;&quot;&lt;path style=&quot;</span>stroke:${color};stroke-width:<span class="dv">1</span><span class="st">&quot; &quot;&quot;&quot;</span> + </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true"></a>s<span class="st">&quot;&quot;&quot;stroke-linejoin=&quot;</span>miter<span class="st">&quot; fill=&quot;</span>none<span class="st">&quot; d=&quot;</span>M ${xStart} ${yStart}<span class="st">&quot;&quot;&quot;)</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true"></a>    <span class="kw">val</span> last = Iterator.<span class="fu">iterate</span>((Seq(<span class="ch">&#39;1&#39;</span>),Seq(<span class="ch">&#39;0&#39;</span>))){</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true"></a>      <span class="kw">case</span> (f1,f2) =&gt; (f2,f2++f1)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true"></a>    }.<span class="fu">map</span>(_._<span class="dv">1</span>).<span class="fu">drop</span>(n).<span class="fu">next</span>.<span class="fu">foldLeft</span>((<span class="ch">&#39;h&#39;</span> -&gt; <span class="dv">1</span>),<span class="kw">true</span>){</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true"></a>      <span class="kw">case</span> ((t,parity),<span class="ch">&#39;1&#39;</span>) <span class="kw">if</span> t._<span class="dv">2</span> &gt; <span class="dv">0</span> =&gt; ((t._<span class="dv">1</span>, t._<span class="dv">2</span> + <span class="dv">1</span>), !parity)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true"></a>      <span class="kw">case</span> ((t,parity),<span class="ch">&#39;1&#39;</span>) <span class="kw">if</span> t._<span class="dv">2</span> &lt; <span class="dv">0</span> =&gt; ((t._<span class="dv">1</span>, t._<span class="dv">2</span> - <span class="dv">1</span>), !parity)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true"></a>      <span class="kw">case</span> ((t,<span class="kw">true</span>), <span class="ch">&#39;0&#39;</span>) =&gt; {</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true"></a>        <span class="fu">stringHandler</span>(s<span class="st">&quot; ${t._1} ${t._2 * lengthMultiplier}&quot;</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true"></a>        (<span class="fu">leftTo</span>(t) -&gt; <span class="kw">false</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true"></a>      }</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true"></a>      <span class="kw">case</span> ((t,<span class="kw">false</span>),<span class="ch">&#39;0&#39;</span>) =&gt; {</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true"></a>        <span class="fu">stringHandler</span>(s<span class="st">&quot; ${t._1} ${t._2 * lengthMultiplier}&quot;</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true"></a>        (<span class="fu">rightTo</span>(t) -&gt; <span class="kw">true</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true"></a>      }</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true"></a>    }._<span class="dv">1</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true"></a>    <span class="fu">stringHandler</span>(s<span class="st">&quot;&quot;&quot; ${last._1} ${last._2 * lengthMultiplier}</span><span class="ch">\&quot;</span><span class="st">/&gt;&lt;/svg&gt;&quot;&quot;&quot;</span>)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true"></a>  }</span></code></pre></div>
<p>to get the example above (colored), in a file, one should execute:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode scala"><code class="sourceCode scala"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">val</span> buff = <span class="kw">new</span> java.<span class="fu">io</span>.<span class="fu">BufferedWriter</span>(<span class="kw">new</span> java.<span class="fu">io</span>.<span class="fu">FileWriter</span>(<span class="st">&quot;/path/to/output/image.svg&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>buff.<span class="fu">write</span>(<span class="st">&quot;&quot;&quot;&lt;?xml version=&quot;</span><span class="fl">1.0</span><span class="st">&quot; encoding=&quot;</span>utf<span class="dv">-8</span><span class="st">&quot;?&gt;&quot;&quot;&quot;</span> + </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="st">&quot;&quot;&quot;&lt;!DOCTYPE svg PUBLIC &quot;</span>-<span class="co">//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/&quot;&quot;&quot; +</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="st">&quot;&quot;&quot;SVG/1.1/DTD/svg11.dtd&quot;</span>&gt;<span class="st">&quot;&quot;&quot;)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="fu">drawFibonacciFractal</span>(<span class="dv">20</span>, <span class="dv">172</span>, <span class="dv">411</span>, <span class="dv">2</span>, <span class="dv">170</span>, <span class="st">&quot;#ffb01c&quot;</span>, <span class="dv">1</span>){</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>  s =&gt; buff.<span class="fu">append</span>(s)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>}</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>buff.<span class="fu">flush</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>buff.<span class="fu">close</span></span></code></pre></div>
